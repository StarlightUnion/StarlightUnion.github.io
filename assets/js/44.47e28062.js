(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{740:function(s,t,e){"use strict";e.r(t);var a=e(39),n=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"如何发布一个npm包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何发布一个npm包"}},[s._v("#")]),s._v(" 如何发布一个npm包？")]),s._v(" "),t("ClientOnly",[t("display-bar",{attrs:{displayData:s.$frontmatter}})],1),s._v(" "),t("blockquote",[t("p",[s._v("本文记录发布"),t("code",[s._v("npm")]),s._v("包的经过。")]),s._v(" "),t("p",[s._v("之前想要模仿某脚手架，使用"),t("code",[s._v("TypeScript")]),s._v("写一个自己的脚手架，顺便锻炼一下自己的"),t("code",[s._v("TypeScript")]),s._v("能力，结果"),t("strong",[s._v("搭个开发框架就花了两天")]),s._v("，现在总算能"),t("strong",[s._v("发包")]),s._v("了。")])]),s._v(" "),t("h2",{attrs:{id:"一、发包前准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、发包前准备"}},[s._v("#")]),s._v(" 一、发包前准备")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("一个"),t("code",[s._v("npm")]),s._v("包必须要有一个"),t("code",[s._v("package.json")]),s._v("，这个在初始化的时候使用"),t("code",[s._v("npm init")]),s._v("命令就可以生成。")])]),s._v(" "),t("li",[t("p",[s._v("在根目录下添加"),t("code",[s._v(".npmignore")]),s._v("文件，该文件用于设置一个目录（或者叫"),t("strong",[s._v("黑名单")]),s._v("），发布时会忽略目录里的文件。")]),s._v(" "),t("p",[s._v("比如我们使用"),t("code",[s._v("TypeScript")]),s._v("写的话必须编译成JS使用，那么就可以在发包的时候忽略源码，仅发布编译后的代码。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# .npmignore 示例\n\nnode_modules\nsrc/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("必须要有"),t("code",[s._v("npm")]),s._v("账号，需要先"),t("a",{attrs:{href:"https://www.npmjs.com/signup",target:"_blank",rel:"noopener noreferrer"}},[s._v("注册账号"),t("OutboundLink")],1),s._v("。")])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("忽略规则")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("如果包的根目录下没有"),t("code",[s._v(".npmignore")]),s._v("文件，将使用"),t("code",[s._v(".gitignore")]),s._v("的配置作为"),t("strong",[s._v("黑名单")]),s._v("。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("package.json")]),s._v("里面的"),t("code",[s._v("files")]),s._v("字段也可以设置发包时的文件目录，但是它是"),t("strong",[s._v("白名单")]),s._v("。")])]),s._v(" "),t("li",[t("p",[s._v("优先级："),t("code",[s._v("files")]),s._v("（白名单） > "),t("code",[s._v(".npmignore")]),s._v("（黑名单） > "),t("code",[s._v(".gitignore")]),s._v("（黑名单）。")])])])]),s._v(" "),t("h2",{attrs:{id:"二、发包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、发包"}},[s._v("#")]),s._v(" 二、发包")]),s._v(" "),t("p",[s._v("发包主要就两个命令：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" adduser "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加用户并登陆")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[s._v("⚠️注意")]),s._v(" "),t("p",[s._v("如果使用"),t("code",[s._v("cnpm")]),s._v("在开发中安装"),t("code",[s._v("node_modules")]),s._v("的话，就会在生成的"),t("code",[s._v("package-lock.json")]),s._v("中将依赖包的源地址变为淘宝镜像：")]),s._v(" "),t("p",[t("code",[s._v("https://registry.npm.taobao.org/xxx")]),s._v("，")]),s._v(" "),t("p",[s._v("就会出现下面的情况，登陆了半天登不上去，然后返回了个500。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/images/frontend/npm/package-publish-01.png",alt:"package-publish-01"}})]),s._v(" "),t("p",[s._v("此时要使用以下命令代替：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" adduser "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--registry")]),s._v(" http://registry.npmjs.org\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--registry")]),s._v(" http://registry.npmjs.org\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])]),s._v(" "),t("p",[s._v("发布成功后就会收到"),t("code",[s._v("npm")]),s._v("发来的邮件！包就发成了！！！")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("WARNING")]),s._v(" "),t("p",[s._v("由于"),t("code",[s._v("cnpm")]),s._v("使用的是镜像源地址，它与"),t("code",[s._v("npm")]),s._v("同步的时间大概是"),t("strong",[s._v("10分钟左右一次")]),s._v("，所以我们刚发布的包使用"),t("code",[s._v("cnpm")]),s._v("安装的话大概率找不到包，还是用"),t("code",[s._v("npm")]),s._v("吧。")])])],1)}),[],!1,null,null,null);t.default=n.exports}}]);