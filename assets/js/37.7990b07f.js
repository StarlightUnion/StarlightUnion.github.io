(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{734:function(s,t,a){"use strict";a.r(t);var n=a(39),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"【javascript进阶】从import和require到js模块化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【javascript进阶】从import和require到js模块化"}},[s._v("#")]),s._v(" 【JavaScript进阶】从import和require到JS模块化")]),s._v(" "),t("ClientOnly",[t("display-bar",{attrs:{displayData:s.$frontmatter}})],1),s._v(" "),t("h2",{attrs:{id:"一、javascript模块标准"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、javascript模块标准"}},[s._v("#")]),s._v(" 一、JavaScript模块标准")]),s._v(" "),t("p",[s._v("在JavaScript中，存在两种模块化标准。第一种是ES6模块化标准（以下简称"),t("code",[s._v("ESM")]),s._v("），另一种则是"),t("code",[s._v("CommonJS")]),s._v("规范（以下简称"),t("code",[s._v("CJS")]),s._v("）。")]),s._v(" "),t("p",[t("font",{attrs:{color:"red"}},[s._v("⚠️二者互不兼容。")])],1),s._v(" "),t("p",[s._v("其中"),t("code",[s._v("CJS")]),s._v("最早出现。在此之前，前端没有模块化概念，在各种插件中的变量命名"),t("strong",[s._v("容易污染全局作用域")]),s._v("，简直就是灾难。")]),s._v(" "),t("hr"),s._v(" "),t("p",[t("code",[s._v("import/export")]),s._v("和"),t("code",[s._v("require/exports")]),s._v("分属于"),t("code",[s._v("ESM")]),s._v("和"),t("code",[s._v("CJS")]),s._v("标准，它们有很大的区别。")]),s._v(" "),t("h3",{attrs:{id:"_1-cjs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-cjs"}},[s._v("#")]),s._v(" 1."),t("code",[s._v("CJS")])]),s._v(" "),t("p",[t("code",[s._v("CJS")]),s._v("先于"),t("code",[s._v("ESM")]),s._v("被提出，"),t("code",[s._v("CJS")]),s._v("诞生之初是为了在"),t("strong",[s._v("浏览器环境之外")]),s._v("的地方使用模块化的JavaScript。")]),s._v(" "),t("blockquote",[t("p",[s._v("在"),t("code",[s._v("CJS")]),s._v("中，"),t("strong",[s._v("每一个文件就是一个模块，拥有自己独立的作用域，变量，以及方法等，对其他的模块都不可见。"),t("code",[s._v("CommonJS")]),s._v("规范规定，每个模块内部，"),t("code",[s._v("module")]),s._v("变量代表当前模块。这个变量是一个对象，它的"),t("code",[s._v("exports")]),s._v("属性（即"),t("code",[s._v("module.exports")]),s._v("）是对外的接口。加载某个模块，其实是加载该模块的"),t("code",[s._v("module.exports")]),s._v("属性。"),t("code",[s._v("require")]),s._v("方法用于加载模块。")]),s._v(" "),t("em",[s._v("—— 阮一峰")])])]),s._v(" "),t("p",[s._v("Node采用"),t("code",[s._v("CJS")]),s._v("规范，所以我们会发现"),t("code",[s._v("CJS")]),s._v("模块通常需要Node环境的支持，换句话说，它需要服务器环境的支持。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("要点")]),s._v(" "),t("ul",[t("li",[s._v("1."),t("code",[s._v("Node")]),s._v("支持"),t("code",[s._v("CJS")]),s._v("和"),t("code",[s._v("ESM")]),s._v("，参考"),t("a",{attrs:{href:"#%E4%B8%89%E3%80%81esm%E5%92%8Ccjs%E6%A8%A1%E5%9D%97%E7%9A%84%E7%9B%B8%E4%BA%92%E5%8A%A0%E8%BD%BD"}},[s._v("esm和cjs模块的相互加载")]),s._v("。")]),s._v(" "),t("li",[s._v("2."),t("code",[s._v("CJS")]),t("strong",[s._v("不能在浏览器中运行")]),s._v("，但可以将其转换成"),t("code",[s._v("ESM")]),s._v("后在浏览器中运行。")])])]),s._v(" "),t("h3",{attrs:{id:"_2-esm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-esm"}},[s._v("#")]),s._v(" 2."),t("code",[s._v("ESM")])]),s._v(" "),t("p",[t("code",[s._v("ESM")]),s._v("是ECMAScript标准的模块化标准，在"),t("strong",[s._v("ES6")]),s._v("中被正式提出。在此之前的"),t("code",[s._v("CJS")]),s._v("标准应用场景是服务端环境，"),t("code",[s._v("ESM")]),s._v("则是用于"),t("strong",[s._v("浏览器环境")]),s._v("。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("要点")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("1."),t("code",[s._v("ESM")]),s._v("加载时属于"),t("strong",[s._v("静态加载")]),s._v("，可以在加载时进行"),t("code",[s._v("Tree Shaking")]),s._v("，即"),t("strong",[s._v("树摇")]),s._v("，去除"),t("strong",[s._v("模块中引入了却未被使用的方法")]),s._v("，以减小打包后的代码体积，获得更快的加载速度。")])]),s._v(" "),t("li",[t("p",[s._v("2."),t("code",[s._v("ESM")]),s._v("可以直接在"),t("strong",[s._v("现代浏览器")]),s._v("中运行。例👇：")]),s._v(" "),t("div",{staticClass:"language-html line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-html"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("script")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token script"}},[t("span",{pre:!0,attrs:{class:"token language-javascript"}},[s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n")])]),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("script")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])])])]),s._v(" "),t("h3",{attrs:{id:"_3-二者区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-二者区别"}},[s._v("#")]),s._v(" 3.二者区别")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("如何简单区分二者")]),s._v("：👇")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("CJS")]),s._v("："),t("code",[s._v("require/exports")])]),s._v(" "),t("li",[t("code",[s._v("ESM")]),s._v("："),t("code",[s._v("import/export")])])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("加载时的区别：")])]),s._v(" "),t("p",[t("code",[s._v("CJS")]),s._v("属于"),t("strong",[s._v("运行时加载（动态加载），理论上可以放在代码的任何地方")]),s._v("，"),t("code",[s._v("CJS")]),s._v("在加载时会加载模块内的所有的东西，使用其中的一种或几种。而"),t("code",[s._v("ESM")]),s._v("属于"),t("strong",[s._v("编译时加载（静态加载），必须放在代码顶部")]),s._v("，它可以在编译时就完成模块加载，速度比较快。")])])]),s._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[s._v("为何动态加载不能进行Tree Shaking，只有静态加载时可以？")]),s._v(" "),t("p",[t("code",[s._v("CJS")]),s._v("属于运行时加载，可以在代码中的任何地方引入，如果有以下代码片段：")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("flag"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    myModule "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a_module_path"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    myModule "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b_module_path"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("由于无法确定用到了哪个模块，所以无法进行"),t("code",[s._v("Tree Shaking")]),s._v("。")]),s._v(" "),t("hr"),s._v(" "),t("p",[s._v("与"),t("code",[s._v("CJS")]),s._v("不同的是"),t("code",[s._v("ESM")]),s._v("中所有模块必须在代码顶部声明引入。")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" AModule "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a_module_path"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" BModule "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b_module_path"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])]),s._v(" "),t("h2",{attrs:{id:"二、import-export和require-exports的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、import-export和require-exports的使用"}},[s._v("#")]),s._v(" 二、"),t("code",[s._v("import/export")]),s._v("和"),t("code",[s._v("require/exports")]),s._v("的使用")]),s._v(" "),t("h3",{attrs:{id:"_1-import-export"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-import-export"}},[s._v("#")]),s._v(" 1."),t("code",[s._v("import/export")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// module")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" func"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" func"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" func"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" func1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" func2 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"other_module_path"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// main")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" func "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" newFunc "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" func "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" funcModule "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" func "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" func "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h3",{attrs:{id:"_2-require-exports"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-require-exports"}},[s._v("#")]),s._v(" 2."),t("code",[s._v("require/exports")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// module")]),s._v("\nmodule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("func")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// main")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" funcModule "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 全部引入")]),s._v("\nfuncModule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h2",{attrs:{id:"三、esm和cjs模块的相互加载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、esm和cjs模块的相互加载"}},[s._v("#")]),s._v(" 三、"),t("code",[s._v("ESM")]),s._v("和"),t("code",[s._v("CJS")]),s._v("模块的相互加载")]),s._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[s._v("⚠️注意")]),s._v(" "),t("p",[s._v("值得注意的是，两种模块的相互加载需要在"),t("code",[s._v("Node")]),s._v("环境下，"),t("strong",[s._v("因为"),t("code",[s._v("CJS")]),s._v("模块不能在浏览器中运行")]),s._v("。")])]),s._v(" "),t("h3",{attrs:{id:"_1-在esm中引入cjs模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-在esm中引入cjs模块"}},[s._v("#")]),s._v(" 1.在"),t("code",[s._v("ESM")]),s._v("中引入"),t("code",[s._v("CJS")]),s._v("模块")]),s._v(" "),t("p",[t("code",[s._v("import")]),s._v("可以加载"),t("code",[s._v("CJS")]),s._v("模块，但是必须是整体加载，否则会报错。👇")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// module 为CJS模块")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" module "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// √")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" func "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ×")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 部分加载")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" module "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" func "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("在"),t("code",[s._v("Node")]),s._v("环境中使用"),t("code",[s._v("import")]),s._v("加载"),t("code",[s._v("CJS")]),s._v("模块时，"),t("code",[s._v("Node")]),s._v("会将"),t("code",[s._v("CJS")]),s._v("模块的"),t("code",[s._v("module.exports")]),s._v("输出的结果作为"),t("strong",[s._v("默认输出")]),s._v("。即"),t("code",[s._v("module.exports")]),s._v("等于"),t("code",[s._v("export dafult")]),s._v("。👇")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CJS module")]),s._v("\nmodule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("a")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("b")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// main")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" module "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// module: {a: "a", b: "b"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" module "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// module: {a: "a", b: "b"}')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"_2-在cjs中引入esm模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-在cjs中引入esm模块"}},[s._v("#")]),s._v(" 2.在"),t("code",[s._v("CJS")]),s._v("中引入"),t("code",[s._v("ESM")]),s._v("模块")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ESM module")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fun!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// main")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" module "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ×")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// {default: {...}, ...}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" module "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("default"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// √")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h2",{attrs:{id:"四、浏览器如何加载cjs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、浏览器如何加载cjs"}},[s._v("#")]),s._v(" 四、浏览器如何加载"),t("code",[s._v("CJS")])]),s._v(" "),t("p",[s._v("上面一节的"),t("a",{attrs:{href:"#%E4%B8%89%E3%80%81esm%E5%92%8Ccjs%E6%A8%A1%E5%9D%97%E7%9A%84%E7%9B%B8%E4%BA%92%E5%8A%A0%E8%BD%BD"}},[s._v("ESM和CJS模块的相互加载")]),s._v("实际上讲的是如何在"),t("code",[s._v("Node")]),s._v("环境加载"),t("code",[s._v("ESM")]),s._v("，那么浏览器环境下如何加载"),t("code",[s._v("CJS")]),s._v("？")]),s._v(" "),t("p",[s._v("答案是"),t("strong",[s._v("转格式")]),s._v("。。详见"),t("a",{attrs:{href:"#%E4%BA%94%E3%80%81%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"}},[s._v("参考资料[4]")]),s._v("。")]),s._v(" "),t("h2",{attrs:{id:"五、参考资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、参考资料"}},[s._v("#")]),s._v(" 五、参考资料")]),s._v(" "),t("ul",[t("li",[t("em",[s._v("1."),t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/113009496",target:"_blank",rel:"noopener noreferrer"}},[s._v("前端科普系列-CommonJS：不是前端却革命了前端"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("em",[s._v("2."),t("a",{attrs:{href:"https://blog.csdn.net/qq_18547381/article/details/105679955",target:"_blank",rel:"noopener noreferrer"}},[s._v("CommonJS模块与ES6模块相互加载"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("em",[s._v("3."),t("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2020/08/how-nodejs-use-es6-module.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Node.js 如何处理 ES6 模块 - 阮一峰的网络日志"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("em",[s._v("4."),t("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2015/05/commonjs-in-browser.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("浏览器加载 CommonJS 模块的原理与实现 - 阮一峰的网络日志"),t("OutboundLink")],1)])])])],1)}),[],!1,null,null,null);t.default=e.exports}}]);